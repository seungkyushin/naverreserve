<!DOCTYPE html>
<html lang="ko">

<head>
<meta charset="utf-8">
<meta name="description"
	content="네이버 예약, 네이버 예약이 연동된 곳 어디서나 바로 예약하고, 네이버 예약 홈(나의예약)에서 모두 관리할 수 있습니다.">
<meta name="viewport"
	content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no">
<title>네이버 예약</title>
<link href="../css/style.css" rel="stylesheet">
<script	src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.11/handlebars.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<style>
.container_visual {
	height: 414px;
}
</style>
</head>

<body>
	<div id="container">
		<div class="header fade">
			<header class="header_tit">
				<h1 class="logo">
					<a href="./mainpage.html" class="lnk_logo" title="네이버"> <span
						class="spr_bi ico_n_logo">네이버</span>
					</a> <a href="../" class="lnk_logo" title="예약"> <span
						class="spr_bi ico_bk_logo">예약</span>
					</a>
				</h1>
				<a href="./bookinglogin.html" class="btn_my"> <span title="예약확인">예약확인</span>
				</a>
			</header>
		</div>
		<div class="ct main">
			<div>
				<div class="section_visual">
					<header>
						<h1 class="logo">
							<a href="./mainpage.html" class="lnk_logo" title="네이버"> <span
								class="spr_bi ico_n_logo">네이버</span>
							</a> <a href="../" class="lnk_logo" title="예약"> <span
								class="spr_bi ico_bk_logo">예약</span>
							</a>
						</h1>
						<a href="./myreservation.html" class="btn_my"> <span
							class="viewReservation" title="예약확인">예약확인</span>
						</a>
					</header>
					<div class="pagination">
						<div class="bg_pagination"></div>
						<div class="figure_pagination">
							<span class="num">0</span> <span class="num off">/<span>0</span></span>
						</div>
					</div>
					<div class="group_visual">
						<div>
							<div class="container_visual" style="width: 414px;">
								<ul class="visual_img detail_swipe">
									<!-- template_item_img -->
								</ul>
							</div>
							<div class="prev">
								<div class="prev_inn">
									<a href="#" class="btn_prev" title="이전"> <!-- [D] 첫 이미지 이면 off 클래스 추가 -->
										<i class="spr_book2 ico_arr6_lt off"></i>
									</a>
								</div>
							</div>
							<div class="nxt">
								<div class="nxt_inn">
									<a href="#" class="btn_nxt" title="다음"> <i
										class="spr_book2 ico_arr6_rt"></i>
									</a>
								</div>
							</div>
						</div>
					</div>
					<div class="group_btn_goto" style="display: none;">
						<a class="btn_goto_home" title="홈페이지" href="#" target="siteUrl">
							<i class="fn fn-home1"></i>
						</a> <a class="btn_goto_tel" title="전화" href="#"> <i
							class="fn fn-call1"></i>
						</a> <a class="btn_goto_mail" title="이메일" href="#"> <i
							class="fn fn-mail1"></i>
						</a> <a href="#" class="btn_goto_path" title="길찾기"> <i
							class="fn fn-path-find1"></i>
						</a> <a href="#" class="fn fn-share1 naver-splugin btn_goto_share"
							title="공유하기"></a>
					</div>
				</div>
				<div class="section_store_details">
					<!-- [D] 펼쳐보기 클릭 시 store_details에 close3 제거 -->
					<div class="store_details close3">
						<p class="dsc"></p>
					</div>
					<!-- [D] 토글 상황에 따라 bk_more에 display:none 추가 -->
					<a href="#" class="bk_more _open" >
						 <span class="bk_more_txt">펼쳐보기</span>
						 <i class="fn fn-down2"></i>
					</a> <a href="#" class="bk_more _close" style="display: none;"> 
					     <span class="bk_more_txt"> 접기</span>
					     <i class="fn fn-up2"></i>
					</a>
				</div>
				<div class="section_event">
					<div class="event_info_box">
						<div class="event_info_tit">
							<h4 class="in_tit">
								<i class="spr_book ico_evt"></i> <span>이벤트 정보</span>
							</h4>
						</div>
						<div class="event_info">
							<div class="in_dsc">
								NONE
							</div>
						</div>
					</div>
				</div>
				<div class="section_btn">
					<button type="button" class="bk_btn" data-id="0">
						<i class="fn fn-nbooking-calender2"></i> <span>예매하기</span>
					</button>
				</div>
				<div class="section_review_list">
					<div class="review_box">
						<h3 class="title_h3">예매자 한줄평</h3>
						<div class="short_review_area">
							<div class="grade_area">
								<!-- [D] 별점 graph_value는 퍼센트 환산하여 width 값을 넣어줌 -->
								<span class="graph_mask"> <em class="graph_value"
									style="width: 84%;"></em>
								</span> <strong class="text_value"> <span>4.2</span> <em
									class="total">5.0</em>
								</strong> <span class="join_count"><em class="green">52건</em> 등록</span>
							</div>
							<ul class="list_short_review">
								<li class="list_item">
									<div>
										<div class="review_area">
											<div class="thumb_area">
												<a href="#" class="thumb" title="이미지 크게 보기"> <img
													width="90" height="90" class="img_vertical_top"
													src="http://naverbooking.phinf.naver.net/20170306_3/1488772023601A4195_JPEG/image.jpg?type=f300_300"
													alt="리뷰이미지">
												</a> <span class="img_count" style="display: none;">1</span>
											</div>
											<h4 class="resoc_name"></h4>
											<p class="review">2층이어서 걱정했는데 꽤잘보여서 좋았습니다 고미오 너무 멋있었습니다
												사진은 커튼콜때 찍었습니다 끝나고 퇴근길도 봐서 너무 좋았어요</p>
										</div>
										<div class="info_area">
											<div class="review_info">
												<span class="grade">4.0</span> <span class="name">dbfl****</span>
												<span class="date">2017.3.5. 방문</span>
											</div>
										</div>
									</div>
								</li>
								<li class="list_item">
									<div>
										<div class="review_area no_img">
											<h4 class="resoc_name"></h4>
											<p class="review">
												너무 재밌게봤구요~<br>마지막공연 후 뒷풀이도 잘봤습니다
											</p>
										</div>
										<div class="info_area">
											<div class="review_info">
												<span class="grade">5.0</span> <span class="name">yyck****</span>
												<span class="date">2017.3.5. 방문</span>
											</div>
										</div>
									</div>
								</li>
								<li class="list_item">
									<div>
										<div class="review_area no_img">
											<h4 class="resoc_name"></h4>
											<p class="review">
												좋은 공연이었습니다. <br>머큐쇼역활 하신분의 열창이 기억에 남는 반면에,,, 로미오는 별로
												기억에 남지 않네요..
											</p>
										</div>
										<div class="info_area">
											<div class="review_info">
												<span class="grade">4.0</span> <span class="name">xero****</span>
												<span class="date">2017.3.4. 방문</span>
											</div>
										</div>
									</div>
								</li>
							</ul>
						</div>
						<p class="guide">
							<i class="spr_book2 ico_bell"></i> <span>네이버 예약을 통해 실제 방문한
								이용자가 남긴 평가입니다.</span>
						</p>
					</div>
					<a class="btn_review_more" href="./review.html"> <span>예매자
							한줄평 더보기</span> <i class="fn fn-forward1"></i>
					</a>
				</div>
				<div class="section_info_tab">
					<!-- [D] tab 선택 시 anchor에 active 추가 -->
					<ul class="info_tab_lst">
						<li class="item active _detail"><a href="#test1"
							class="anchor active" id="test1"> <span>상세정보</span>
						</a></li>
						<li class="item _path"><a href="#test" class="anchor" id="test"> <span>오시는길</span>
						</a></li>
					</ul>
					<!-- [D] 상세정보 외 다른 탭 선택 시 detail_area_wrap에 hide 추가 -->
					<div class="detail_area_wrap">
						<div class="detail_area">
							<div class="detail_info">
								<h3 class="blind">상세정보</h3>
								<ul class="detail_info_group">
									<li class="detail_info_lst"><strong class="in_tit">[소개]</strong>
										<p class="in_dsc"></p></li>
									<li class="detail_info_lst"><strong class="in_tit">[공지사항]</strong>
										<ul class="in_img_group">
											<li class="in_img_lst"><img alt="" class="img_thumb"
												src="/naverreserve/img/notice.jpg">
											</li>
										</ul></li>
								</ul>
							</div>
						</div>
					</div>
					<!-- [D] 오시는길 외 다른 탭 선택 시 detail_location에 hide 추가 -->
					<div class="detail_location hide">
						<div class="box_store_info no_topline">
							<a href="#" class="store_location" title="지도웹으로 연결"> <img
								class="store_map img_thumb" alt="map" src="#">
								<span class="img_border"></span> <span class="btn_map"><i
									class="spr_book2 ico_mapview"></i></span>
							</a>
							<h3 class="store_name">None</h3>
							<div class="store_info">
								<div class="store_addr_wrap">
									<span class="fn fn-pin2"></span>
									<p class="store_addr store_addr_bold">None</p>
									<p class="store_addr">
										<span class="addr_old">지번</span> <span class="addr_old_detail">None</span>
									</p>
									<p class="store_addr addr_detail">None</p>
								</div>
								<div class="lst_store_info_wrap">
									<ul class="lst_store_info">
										<li class="item"><span class="item_lt"> <i
												class="fn fn-call2"></i> <span class="sr_only">전화번호</span>
										</span> <span class="item_rt"> <a href="tel:0000"
												class="store_tel">000-0000-0000</a></span></li>
									</ul>
								</div>
							</div>
							<!-- [D] 모바일 브라우저에서 접근 시 column2 추가와 btn_navigation 요소 추가 -->
							<div class="bottom_common_path column2">
								<a href="#" class="btn_path"> <i class="fn fn-path-find2"></i>
									<span>길찾기</span>
								</a> <a href="#" class="btn_navigation before"> <i
									class="fn fn-navigation2"></i> <span>내비게이션</span>
								</a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<footer>
		<div class="gototop">
			<a href="#" class="lnk_top"> <span class="lnk_top_text">TOP</span>
			</a>
		</div>
		<div class="footer">
			<p class="dsc_footer">네이버(주)는 통신판매의 당사자가 아니며, 상품의정보, 거래조건, 이용 및
				환불 등과 관련한 의무와 책임은 각 회원에게 있습니다.</p>
			<span class="copyright">© NAVER Corp.</span>
		</div>
	</footer>
	<div id="photoviwer"></div>

	<script type="text/template" id="template_item_2">

</script>
	<script type="text/template" id="template_item_img">

 <li class="item" style="width: 414px; "> 

	<img alt="{{discription}}" class="img_thumb" src="/naverreserve/{{saveFileName}}">

		 <span class="img_bg">class img_bg</span>

                 <div class="visual_txt">
                     <div class="visual_txt_inn">
                          	<h2 class="visual_txt_tit"> 
								<span>{{discription}}</span>
						 	</h2>
                  		  	<p class="visual_txt_dsc">class visual_txt_dsc</p>
                     </div>
                 </div>
  </li>

</script>

	<script>
function myAjax(url,http,func){
	var xhttp = new XMLHttpRequest();
	xhttp.onreadystatechange = function(){
		 if (this.readyState == 4 && this.status == 200) {
			func(this);
		 }
		 
	}
	xhttp.open(url, http);
	xhttp.send();
}
function getUrlparams(paramName)
{
	var url = document.location.href;
	var parameters = (url.slice(url.indexOf('?') + 1, url.length)).split('&');
	var returnValue;
	parameters.forEach(function(d){
		 var varName = d.split('=')[0];
		 
		 if (varName.toUpperCase() == paramName.toUpperCase()) {
			 	 returnValue = d.split('=')[1];
			 	 return;
	        }
	});
	
	return returnValue;
}

window.addEventListener("DOMContentLoaded",function(){

	//< URL을 받아와 설정 
	myAjax("GET","http://localhost:8080/naverreserve/api/products/"+ getUrlparams("displayInfoId"),setProductDetail);
	
	//< 접기 펼치기 jquery 사용 가능  
	$(".section_store_details").click(function(){
		
		if( $(".store_details").hasClass("close3") == true )
			{
				$(".store_details").removeClass("close3");
				$(".bk_more._open").css({"display":"none"});
				$(".bk_more._close").css({"display":"block"});
			}
		else{
				$(".store_details").addClass("close3");
				$(".bk_more._open").css({"display":"block"});
				$(".bk_more._close").css({"display":"none"});

		}
	});
	
	//< 예매하기 버튼 
	reservationBtn();
	//< 클릭 활성화
	SetInfoTab();
	
});


function reservationBtn(){
	var rvBtn = document.querySelector(".bk_btn");
	
	rvBtn.addEventListener("click",function(){
		location.href = "http://localhost:8080/naverreserve/views/reserve.html?id=" + getUrlparams("displayInfoId");
	});
}

function SetInfoTab(){
var infoTab = document.querySelector(".info_tab_lst");
	
	infoTab.addEventListener("click",function(e){
		for(var i=0 ; i < infoTab.childElementCount; i++)
			{
				if( e.target.innerText == infoTab.children[i].innerText)
				{
					infoTab.children[i].firstElementChild.className = "anchor active";

					if( e.target.innerText == "오시는길")
						{
							var detailArea = document.querySelector(".detail_area_wrap");
							detailArea.className ="detail_area_wrap hide";
							
							var detailLocation = document.querySelector(".detail_location");
							detailLocation.className ="detail_location";
						}
					else if( e.target.innerText == "상세정보")
						{
							var detailArea = document.querySelector(".detail_area_wrap");
							detailArea.className ="detail_area_wrap";
							
							var detailLocation = document.querySelector(".detail_location");
							detailLocation.className ="detail_location hide";
						}
					
					
				}
				else
					infoTab.children[i].firstElementChild.className = "anchor";
			}
		
			
	});
}

function setProductDetail(response){
	var responseData = JSON.parse(response.responseText);
	
	
	var template = document.querySelector("#template_item_img");
	var parser = Handlebars.compile(template.innerText); 
	var dataSize = responseData.productImages.length;
	
	//< 이미지 개수 설정
	var num = document.querySelector(".num");
	var numOff = document.querySelector(".num.off");
	num.innerHTML = 1;
	numOff.children[0].innerHTML=dataSize;

	//< 이미지 개수가 1개일경우 화살표 UI 숨김
	var btn_prev = document.querySelector(".prev");
	var btn_nxt = document.querySelector(".nxt");
	if(dataSize == 1)
	{
		btn_prev.className ="prev hide";
		btn_nxt.className ="nxt hide";
	}
                       
	
	//< 이미지 및 세부 정보 설정 
	var visualImgGroup = document.querySelector(".visual_img.detail_swipe");
	for(var i = 0; i < dataSize; i++)
		{
			var data = {
						discription : responseData.product.discription,	
						saveFileName : responseData.productImages[i].saveFileName
			};
			
			var Resulthtml = parser(data);
			visualImgGroup.innerHTML += Resulthtml;
		}

	//< 이벤트 설정
	var eventInfo = document.querySelector(".event_info");
	eventInfo.firstElementChild.innerText = responseData.product.event;
	
		
	//< VisuaImgGroup아래의 세부 소개 설정
	var displayDicription = document.querySelector(".store_details.close3");
		displayDicription.children[0].innerHTML = responseData.product.content;
	
	//< 세부 정보 소개 설정 
	var detailInfo = document.querySelector(".detail_info_group");
	var detailInfoIntroduce= detailInfo.querySelector(".in_dsc");
	detailInfoIntroduce.innerHTML = responseData.product.content;

	//< 오는길 정보 설정 
	var detailLocation = document.querySelector(".detail_location");
	var mapImg = detailLocation.querySelector(".store_map.img_thumb");
	var discription = detailLocation.querySelector(".store_name");
	
	var placeStreet = detailLocation.querySelector(".store_addr.store_addr_bold");
	var placeStreetDetail = detailLocation.querySelector(".addr_old_detail");
	var placeName = detailLocation.querySelector(".store_addr.addr_detail");
	var tel = detailLocation.querySelector(".store_tel");
	 
	mapImg.src = "/naverreserve/" + responseData.displayInfoImages.saveFileName;
	discription.innerText = responseData.product.discription;
	placeStreet.innerText = responseData.product.placeStreet;
	placeStreetDetail.innerText = responseData.product.placeStreet;
	placeName.innerText = responseData.product.placeName;
	tel.innerText = responseData.product.tel;
	tel.href = "tel:"+responseData.product.tel;

}


</script>
</body>


</html>
